First we usee the hash table to handle the data from the castparser and movie parser. The hash table's insert and check is 0(1) time.
Second we use the procedure to prevent run too many sql statement to prevent the connection and check time from the sql.
Third we use the batch insert instead of navie way. It could let large sql call statement to run one times instead of too many connection time.